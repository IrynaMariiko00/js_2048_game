!function(){var t="idle",e="playing",o="lose",r=new(function(){var r;function a(e,o,r){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),this.board=e||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status=t,this.isStarted=!1,this.winCallback=o,this.loseCallback=r}return r=[{key:"moveTile",value:function(t,e){var o=t.getBoundingClientRect(),r=e.getBoundingClientRect(),a=r.left-o.left,n=r.top-o.top;t.style.setProperty("--x-offset","".concat(a,"px")),t.style.setProperty("--y-offset","".concat(n,"px")),t.classList.add("moving")}},{key:"updateBoard",value:function(){for(var t=document.querySelectorAll(".field-cell"),e=0,o=0;o<this.board.length;o++)for(var r=0;r<this.board[o].length;r++){var a=t[e++],n=this.board[o][r],s=a.textContent;a.classList.remove("field-cell--".concat(s)),0===n?a.textContent="":(a.classList.add("field-cell--".concat(n)),a.textContent=n)}}},{key:"addRandomTile",value:function(){for(var t=[],e=0;e<4;e++)for(var o=0;o<4;o++)0===this.board[e][o]&&t.push({row:e,col:o});if(t.length>0){var r=t[Math.floor(Math.random()*t.length)],a=r.row,n=r.col;0===this.score&&(this.board[a][n]=2),this.updateBoard()}}},{key:"addRandomCellAfterMoving",value:function(){for(var t=[],e=0;e<4;e++)for(var o=0;o<4;o++)0===this.board[e][o]&&t.push({row:e,col:o});if(t.length>0){var r=t[Math.floor(Math.random()*t.length)],a=r.row,n=r.col;this.board[a][n]=.9>Math.random()?2:4,this.updateBoard()}}},{key:"createColumn",value:function(t){for(var e=[],o=0;o<this.board.length;o++)0!==this.board[o][t]&&e.push(this.board[o][t]);return e}},{key:"updateColumn",value:function(t,e){for(var o=!1,r=0;r<this.board.length;r++)this.board[r][t]!==e[r]&&(this.board[r][t]=e[r],o=!0);return o}},{key:"resetGameStart",value:function(){this.score=0,this.status=e,this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.addRandomTile(),this.addRandomTile()}},{key:"mergeTitles",value:function(t,e){for(var o=[],r=0;r<t.length-1;r++)t[r]===t[r+1]&&(t[r]*=2,t.splice(r+1,1),e[r]=!1,o.push(r));return o}},{key:"moveLeft",value:function(){for(var t=this,e=!1,o=0;o<this.board.length;o++)!function(o){for(var r=t.board[o].filter(function(t){return 0!==t}),a=[],n=!1,s=0;s<r.length;s++){if(n){n=!1;continue}r[s]===r[s+1]?(a.push(2*r[s]),t.getScore(!0,2*r[s]),n=!0,e=!0):a.push(r[s])}for(;a.length<t.board[o].length;)a.push(0);if(!e){for(var i=0;i<t.board[o].length;i++)if(t.board[o][i]!==a[i]){e=!0;break}}t.board[o]=a}(o);return e&&(this.addRandomCellAfterMoving(),this.updateBoard(),this.getStatus()),e}},{key:"moveRight",value:function(){for(var t=this,e=!1,o=0;o<this.board.length;o++)!function(o){for(var r=t.board[o].filter(function(t){return 0!==t}),a=[],n=!1,s=0;s<r.length;s++){if(n){n=!1;continue}r[s]===r[s+1]?(a.push(2*r[s]),t.getScore(!0,2*r[s]),n=!0,e=!0):a.push(r[s])}for(;a.length<t.board[o].length;)a.unshift(0);for(var i=0;i<t.board[o].length;i++)if(t.board[o][i]!==a[i]){e=!0;break}t.board[o]=a}(o);return e&&(this.addRandomCellAfterMoving(),this.updateBoard(),this.getStatus()),e}},{key:"moveUp",value:function(){for(var t=!1,e=0;e<this.board.length;e++){for(var o=this.createColumn(e),r=Array(o.length).fill(!0),a=0;a<o.length-1;a++)o[a]===o[a+1]&&r[a]&&r[a+1]&&(o[a]*=2,o.splice(a+1,1),t=!0,r[a]=!1,this.getScore(t,o[a]));for(;o.length<this.board.length;)o.push(0);t=this.updateColumn(e,o)||t}return t&&(this.addRandomCellAfterMoving(),this.updateBoard(),this.getStatus()),t}},{key:"moveDown",value:function(){for(var t=!1,e=0;e<this.board.length;e++){for(var o=this.createColumn(e),r=Array(o.length).fill(!0),a=o.length-1;a>0;a--)o[a]===o[a-1]&&r[a]&&r[a-1]&&(o[a]*=2,o.splice(a-1,1),t=!0,r[a]=!1,this.getScore(t,o[a]));for(;o.length<this.board.length;)o.unshift(0);t=this.updateColumn(e,o)||t}return t&&(this.addRandomCellAfterMoving(),this.updateBoard(),this.getStatus()),t}},{key:"getState",value:function(){return this.board}},{key:"getStatus",value:function(){if(0===this.score)this.status=t;else{for(var r=!1,a=!1,n=!1,s=0;s<this.board.length;s++)for(var i=0;i<this.board[s].length;i++)0===this.board[s][i]&&(r=!0),2048===this.board[s][i]&&(a=!0),s<this.board.length-1&&this.board[s][i]===this.board[s+1][i]&&(n=!0),i<this.board[s].length-1&&this.board[s][i]===this.board[s][i+1]&&(n=!0);a?(this.status="win",this.winCallback()):r||n?this.status=e:(this.status=o,this.loseCallback())}return this.status}},{key:"start",value:function(){this.resetGameStart()}},{key:"restart",value:function(){this.resetGameStart()}}],function(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(a.prototype,r),a}())(null,function(){l.classList.remove("hidden"),l.classList.add("message-win"),l.textContent="You Win!"},function(){l.classList.remove("hidden"),l.classList.add("message-lose"),l.textContent="You Lose!"}),a=document.querySelector(".start"),n=document.querySelectorAll(".field-cell"),s=document.querySelector(".game-score"),i=document.querySelector(".best__score"),l=document.querySelector(".message-container");function h(){l.classList.add("hidden")}function u(){var t=localStorage.getItem("highScore")||0;i.textContent=t}u(),r.getScore=function(t,e){if(t&&e>0){var o,r,a;this.score+=e,o=this.score,s.textContent=o,r=this.score,(a=localStorage.getItem("highScore"))&&!(r>a)||(localStorage.setItem("highScore",r),u())}},a.addEventListener("click",function(){a.textContent="Restart",a.classList.remove("start"),a.classList.add("restart"),s.textContent="0",n.forEach(function(t){t.classList.remove("hidden")}),("win"===r.status||r.status===o)&&h(),r.start(),h(),u()}),document.addEventListener("keydown",function(t){switch(t.key){case"ArrowLeft":r.moveLeft();break;case"ArrowRight":r.moveRight();break;case"ArrowUp":r.moveUp();break;case"ArrowDown":r.moveDown()}})}();
//# sourceMappingURL=index.1ca8bb72.js.map
